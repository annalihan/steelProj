steel.d("utils/kit/extra/hotKey",[],function(e,t,r){STK.register("utils.kit.extra.hotKey",function(e){var t="F_"+e.core.util.getUniqueKey(),r=1,n={27:"esc",9:"tab",32:"space",13:"enter",8:"backspace",145:"scrollclock",20:"capslock",144:"numlock",19:"pause",45:"insert",36:"home",46:"delete",35:"end",33:"pageup",34:"pagedown",37:"left",38:"up",39:"right",40:"down",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",191:"/",17:"ctrl",16:"shift",109:"-",107:"=",219:"[",221:"]",220:"\\",222:"'",187:"=",188:",",189:"-",190:".",191:"/",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",110:".",111:"/"},a={},i=function(e){e=e||window.event,e.target||(e.target=e.srcElement||document),!e.which&&(e.charCode||0===e.charCode?e.charCode:e.keyCode)&&(e.which=e.charCode||e.keyCode);var r,i,l=e.which,s=this[t];if(s&&(r=a[s])&&(i=r[e.type])){var o;switch(e.type){case"keypress":if(e.ctrlKey||e.altKey)return;13==l||32==l?o=n[l]:l>=33&&126>=l&&(o=String.fromCharCode(l));break;case"keyup":case"keydown":(o=n[l])||(l>=48&&57>=l?o=String.fromCharCode(l):l>=65&&90>=l&&(o=String.fromCharCode(l+32))),o&&"keydown"==e.type&&(r.linkedKey+=r.linkedKey?">"+o:o,e.altKey&&(o="alt+"+o),e.shiftKey&&(o="shift+"+o),e.ctrlKey&&(o="ctrl+"+o))}var y=/^select|textarea|input$/.test(e.target.nodeName.toLowerCase());if(o){var c=[],f=!1;r.linkedKey&&r.linkKeyStr&&(-1!=r.linkKeyStr.indexOf(" "+r.linkedKey)?(-1!=r.linkKeyStr.indexOf(" "+r.linkedKey+" ")&&(c=c.concat(i[r.linkedKey]),r.linkedKey=""),f=!0):r.linkedKey=""),f||(c=c.concat(i[o]));for(var d=0;d<c.length;d++)!c[d]||c[d].disableInInput&&y||c[d].fn.apply(this,[e,c[d].key])}}},l=function(t,r,n,a){var i={};if(!e.core.dom.isNode(t)||"function"!==e.core.func.getType(n))return i;if("string"!=typeof r||!(r=r.replace(/\s*/g,"")))return i;if(a=e.core.obj.parseParam({disableInInput:!1,type:"keypress"},a),a.type=a.type.replace(/\s*/g,""),!/^keypress|keydown|keyup$/.test(a.type)||a.disableInInput&&/^select|textarea|input$/.test(t.nodeName.toLowerCase()))return i;if((r.length>1||"keypress"!=a.type)&&(r=r.toLowerCase()),!/(^(\+|>)$)|(^([^\+>]+)$)/.test(r)){var l="";if(/((ctrl)|(shift)|(alt))\+(\+|([^\+]+))$/.test(r))/ctrl\+/.test(r)&&(l+="ctrl+"),/shift\+/.test(r)&&(l+="shift+"),/alt\+/.test(r)&&(l+="alt+"),r=l+=r.match(/\+(([^\+]+)|(\+))$/)[1];else{if(/(^>)|(>$)|>>/.test(r)||!(r.length>2))return i;i.linkFlag=!0}a.type="keydown"}return i.keys=r,i.opts=a,i},s={add:function(n,o,y,c){if(e.core.arr.isArray(o))for(var f=0;f<o.length;f++)s.add(n,o[f],y,c);else{var d=l(n,o,y,c);if(d.keys){o=d.keys,c=d.opts;var k=d.linkFlag;n[t]||(n[t]=r++);var p=n[t];a[p]||(a[p]={linkKeyStr:"",linkedKey:""}),a[p].handler||(a[p].handler=function(){i.apply(n,arguments)}),k&&-1==a[p].linkKeyStr.indexOf(" "+o+" ")&&(a[p].linkKeyStr+=" "+o+" ");var h=c.type;a[p][h]||(a[p][h]={},STK.core.evt.addEvent(n,h,a[p].handler)),a[p][h][o]||(a[p][h][o]=[]),a[p][h][o].push({fn:y,disableInInput:c.disableInInput,key:o})}}},remove:function(r,n,i,o){if(e.core.arr.isArray(n))for(var y=0;y<n.length;y++)s.remove(r,type,n[y],i);else{var c=l(r,n,i,o);if(c.keys){n=c.keys,o=c.opts;var f,d,k,p=c.linkFlag,h=r[t],u=o.type;if(h&&(f=a[h])&&(d=f[u])&&f.handler&&(k=d[n])){for(var y=0;y<k.length;)k[j].fn===i?k.splice(y,1):y++;k.length<1&&delete d[n];var K=!1;for(var v in d){K=!0;break}K||(STK.core.evt.removeEvent(r,u,f.handler),delete f[u]),p&&f.linkKeyStr&&(f.linkKeyStr=f.linkKeyStr.replace(" "+n+" ",""))}}}}};return s})});