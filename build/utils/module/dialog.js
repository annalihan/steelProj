steel.d("utils/module/layer",[],function(e,t,n){STK.register("utils.module.layer",function(e){var t=function(e){var t={};return"none"==e.style.display?(e.style.visibility="hidden",e.style.display="",t.w=e.offsetWidth,t.h=e.offsetHeight,e.style.display="none",e.style.visibility="visible"):(t.w=e.offsetWidth,t.h=e.offsetHeight),t},n=function(n,i){i=i||"topleft";var o=null;if("none"==n.style.display?(n.style.visibility="hidden",n.style.display="",o=e.core.dom.position(n),n.style.display="none",n.style.visibility="visible"):o=e.core.dom.position(n),"topleft"!==i){var r=t(n);"topright"===i?o.l=o.l+r.w:"bottomleft"===i?o.t=o.t+r.h:"bottomright"===i&&(o.l=o.l+r.w,o.t=o.t+r.h)}return o};return function(i){var o=e.core.dom.builder(i),r=o.list.outer[0],u=o.list.inner[0],l=e.core.dom.uniqueID(r),s={},d=e.core.evt.custEvent.define(s,"show");e.core.evt.custEvent.define(d,"hide");var c=null;return s.show=function(){return r.style.display="",e.core.evt.custEvent.fire(d,"show"),s},s.hide=function(){return r.style.display="none",e.custEvent.fire(d,"hide"),s},s.getPosition=function(e){return n(r,e)},s.getSize=function(e){return(e||!c)&&(c=t.apply(s,[r])),c},s.html=function(e){return void 0!==e&&(u.innerHTML=e),u.innerHTML},s.text=function(t){return void 0!==text&&(u.innerHTML=e.core.str.encodeHTML(t)),e.core.str.decodeHTML(u.innerHTML)},s.appendChild=function(e){return u.appendChild(e),s},s.getUniqueID=function(){return l},s.getOuter=function(){return r},s.getInner=function(){return u},s.getParentNode=function(){return r.parentNode},s.getDomList=function(){return o.list},s.getDomListByKey=function(e){return o.list[e]},s.getDom=function(e,t){return o.list[e]?o.list[e][t||0]:!1},s.getCascadeDom=function(t,n){return o.list[t]?e.core.dom.cascadeNode(o.list[t][n||0]):!1},s}})}),steel.d("utils/module/dialog",["utils/module/layer"],function(e,t,n){e("utils/module/layer"),STK.register("utils.module.dialog",function(e){return function(t,n){if(!t)throw"module.dialog need template as first parameter";var i,o,r,u,l,s,d,c,f,a,h,p;f=!0;var y=function(){f!==!1&&o.hide()},m=function(){i=e.parseParam({t:null,l:null,width:null,height:null},n),o=e.utils.module.layer(t,i),u=o.getOuter(),l=o.getDom("title"),c=o.getDom("title_content"),s=o.getDom("inner"),d=o.getDom("close"),e.addEvent(d,"click",function(){h()}),e.custEvent.add(o,"show",function(){e.hotKey.add(document.documentElement,["esc"],y,{type:"keyup",disableInInput:!0})}),e.custEvent.add(o,"hide",function(){e.hotKey.remove(document.documentElement,["esc"],y,{type:"keyup"}),f=!0})};return m(),p=e.objSup(o,["show","hide"]),h=function(t){return"function"!=typeof a||t||a()!==!1?(p.hide(),e.contains(document.body,o.getOuter())&&document.body.removeChild(o.getOuter()),r):!1},r=o,r.show=function(){return e.contains(document.body,o.getOuter())||document.body.appendChild(o.getOuter()),p.show(),r},r.hide=h,r.setPosition=function(e){return u.style.top=e.t+"px",u.style.left=e.l+"px",r},r.setMiddle=function(){var t,n=e.core.util.winSize(),i=o.getSize(!0);if(window.FrameInner&&window.FrameInner.outInfo){var l=FrameInner.outInfo;"string"==typeof l&&(l=e.strToJson(l));var s=l.parent.scroll.top,d=l.iframe.position.top,c=l.parent.size.height;t=s-d+(c-i.h)/2;var f=n.height-i.h;t>f&&(t=f)}else t=e.core.util.scrollPos().top+(n.height-i.h)/2;return u.style.top=(parseInt(t)>30?t:30)+"px",u.style.left=(n.width-i.w)/2+"px",window.FrameInner&&FrameInner.diaAutoHeight&&FrameInner.diaAutoHeight(u),r},r.setTitle=function(e){return c.innerHTML=e,r},r.setContent=function(e){return"string"==typeof e?s.innerHTML=e:s.appendChild(e),r},r.clearContent=function(){for(;s.children.length;)e.removeNode(s.children[0]);return r},r.setAlign=function(){},r.setBeforeHideFn=function(e){a=e},r.clearBeforeHideFn=function(){a=null},r.unsupportEsc=function(){f=!1},r.supportEsc=function(){f=!0},r}})});