steel.d("utils/kit/extra/language",[],function(e,t,n){STK.register("utils.kit.extra.language",function(e){return window.$LANG||(window.$LANG={}),function(t,n){var i=e.core.util.language(t,$LANG);return i=i.replace(/\\}/gi,"}"),n&&(i=e.templet(i,n)),i}})}),steel.d("utils/kit/extra/reuse",[],function(e,t,n){STK.register("utils.kit.extra.reuse",function(e){return function(t,n){var i,r,o;i=e.parseParam({},n),o=[];var u=function(){var e=t();return o.push({store:e,used:!0}),e},s=function(t){e.foreach(o,function(e,n){return t===e.store?(e.used=!0,!1):void 0})},l=function(t){e.foreach(o,function(e,n){return t===e.store?(e.used=!1,!1):void 0})},a=function(){for(var e=0,t=o.length;t>e;e+=1)if(o[e].used===!1)return o[e].used=!0,o[e].store;return u()};return r={},r.setUsed=s,r.setUnused=l,r.getOne=a,r.getLength=function(){return o.length},r}})}),steel.d("utils/kit/dom/textSelection",[],function(e,t,n){STK.register("utils.kit.dom.textSelection",function(e){return function(t,n){var i,r;i={},r=e.parseParam({},n);var o=function(n){return e.core.dom.selectText(t,n)},u=function(){t.__areaQuery=e.jsonToQuery(e.core.dom.textSelectArea(t))},s=function(){t.__areaQuery=!1};e.addEvent(t,"beforedeactivate",u),e.addEvent(t,"active",s);var l=function(){var n=null;try{n=e.core.dom.textSelectArea(t)}catch(i){n=e.queryToJson(t.__areaQuery)}return 0===n.start&&0===n.len&&t.__areaQuery&&(n=e.queryToJson(t.__areaQuery)),n.start=parseInt(n.start,10),n.len=parseInt(n.len,10),n},a=function(e,n){var i=t.value,r=n.start,o=n.len||0,u=i.slice(0,r),s=i.slice(r+o,i.length);t.value=u+e+s,i=null,u=null,s=null;var r=null,o=null};return i.setCursor=function(e){o(e)},i.getCursor=function(){return l()},i.insertCursor=function(e){var t=l();a(e,t),t.len=e.length,o(t)},i.TempletCursor=function(n){var i,r,u;i=l(),r=i.len>0?t.value.substr(i.start,i.len):"",u=e.templet(n,{origin:r}),a(u,i),i.start=i.start+n.indexOf("#{origin"),i.len=u.length-n.replace(/#\{[origin].+?\}/,"").length,o(i)},i.insertText=a,i.destroy=function(){e.removeEvent(t,"beforedeactivate",u),e.removeEvent(t,"active",s),t=null},i}})}),steel.d("utils/kit/dom/smartInput",["utils/kit/dom/textSelection"],function(e,t,n){e("utils/kit/dom/textSelection"),STK.register("utils.kit.dom.smartInput",function(e){return function(t,n){var i,r,o,u,s,l,a,c,d,f,p,v,m,g,h="stop";return i=e.parseParam({notice:"",currentClass:null,noticeClass:null,noticeStyle:null,maxLength:null,needLazyInput:!1,LazyInputDelay:200},n),r=e.cascadeNode(t),s=e.utils.kit.dom.textSelection(t),e.custEvent.define(r,"enter"),e.custEvent.define(r,"ctrlEnter"),e.custEvent.define(r,"lazyInput"),o=function(){i.maxLength&&e.bLength(t.value)>i.maxLength&&(t.value=e.leftB(t.value,i.maxLength))},p=function(){t.value===i.notice&&(t.value="",null!=i.noticeClass&&e.removeClassName(t,i.noticeClass)),null!=i.currentClass&&e.addClassName(t.parentNode,i.currentClass)},v=function(){""===t.value&&(t.value=i.notice,null!=i.noticeClass&&e.addClassName(t,i.noticeClass)),null!=i.currentClass&&e.removeClassName(t.parentNode,i.currentClass)},u=function(){return o(),t.value===i.notice?"":t.value},m=function(t){13===t.keyCode&&e.custEvent.fire(r,"enter",u())},g=function(t){13!==t.keyCode&&10!==t.keyCode||!t.ctrlKey||e.custEvent.fire(r,"ctrlEnter",u())},l=function(){"stop"===h&&(d=setInterval(c,i.LazyInputDelay),h="sleep")},a=function(){clearInterval(d),h="stop"},c=function(){f===t.value?"weakup"===h?(e.custEvent.fire(r,"lazyInput",t.value),h="sleep"):"waiting"===h&&(h="weakup"):h="waiting",f=t.value},i.needLazyInput&&(e.addEvent(t,"focus",l),e.addEvent(t,"blur",a)),e.addEvent(t,"focus",p),e.addEvent(t,"blur",v),e.addEvent(t,"keyup",o),e.addEvent(t,"keydown",m),e.addEvent(t,"keydown",g),r.getValue=u,r.setValue=function(e){return t.value=e,o(),r},r.setNotice=function(e){return i.notice=e,r},r.setNoticeClass=function(e){return i.noticeClass=e,r},r.setNoticeStyle=function(e){return i.noticeStyle=e,r},r.setMaxLength=function(e){return i.maxLength=e,r},r.restart=function(){v()},r.startLazyInput=l,r.stopLazyInput=a,r.setCursor=s.setCursor,r.getCursor=s.getCursor,r.insertCursor=s.insertCursor,r.insertText=s.insertText,r.destroy=function(){i.needLazyInput&&(e.removeEvent(t,"focus",p),e.removeEvent(t,"blur",v)),a(),e.removeEvent(t,"focus",p),e.removeEvent(t,"blur",v),e.removeEvent(t,"keyup",o),e.removeEvent(t,"keydown",m),e.removeEvent(t,"keydown",g),e.custEvent.undefine(r,"enter"),e.custEvent.undefine(r,"ctrlEnter"),e.custEvent.undefine(r,"lazyInput"),s.destroy(),r=null},r}})}),steel.d("utils/module/layer",[],function(e,t,n){STK.register("utils.module.layer",function(e){var t=function(e){var t={};return"none"==e.style.display?(e.style.visibility="hidden",e.style.display="",t.w=e.offsetWidth,t.h=e.offsetHeight,e.style.display="none",e.style.visibility="visible"):(t.w=e.offsetWidth,t.h=e.offsetHeight),t},n=function(n,i){i=i||"topleft";var r=null;if("none"==n.style.display?(n.style.visibility="hidden",n.style.display="",r=e.core.dom.position(n),n.style.display="none",n.style.visibility="visible"):r=e.core.dom.position(n),"topleft"!==i){var o=t(n);"topright"===i?r.l=r.l+o.w:"bottomleft"===i?r.t=r.t+o.h:"bottomright"===i&&(r.l=r.l+o.w,r.t=r.t+o.h)}return r};return function(i){var r=e.core.dom.builder(i),o=r.list.outer[0],u=r.list.inner[0],s=e.core.dom.uniqueID(o),l={},a=e.core.evt.custEvent.define(l,"show");e.core.evt.custEvent.define(a,"hide");var c=null;return l.show=function(){return o.style.display="",e.core.evt.custEvent.fire(a,"show"),l},l.hide=function(){return o.style.display="none",e.custEvent.fire(a,"hide"),l},l.getPosition=function(e){return n(o,e)},l.getSize=function(e){return(e||!c)&&(c=t.apply(l,[o])),c},l.html=function(e){return void 0!==e&&(u.innerHTML=e),u.innerHTML},l.text=function(t){return void 0!==text&&(u.innerHTML=e.core.str.encodeHTML(t)),e.core.str.decodeHTML(u.innerHTML)},l.appendChild=function(e){return u.appendChild(e),l},l.getUniqueID=function(){return s},l.getOuter=function(){return o},l.getInner=function(){return u},l.getParentNode=function(){return o.parentNode},l.getDomList=function(){return r.list},l.getDomListByKey=function(e){return r.list[e]},l.getDom=function(e,t){return r.list[e]?r.list[e][t||0]:!1},l.getCascadeDom=function(t,n){return r.list[t]?e.core.dom.cascadeNode(r.list[t][n||0]):!1},l}})}),steel.d("utils/module/dialog",["utils/module/layer"],function(e,t,n){e("utils/module/layer"),STK.register("utils.module.dialog",function(e){return function(t,n){if(!t)throw"module.dialog need template as first parameter";var i,r,o,u,s,l,a,c,d,f,p,v;d=!0;var m=function(){d!==!1&&r.hide()},g=function(){i=e.parseParam({t:null,l:null,width:null,height:null},n),r=e.utils.module.layer(t,i),u=r.getOuter(),s=r.getDom("title"),c=r.getDom("title_content"),l=r.getDom("inner"),a=r.getDom("close"),e.addEvent(a,"click",function(){p()}),e.custEvent.add(r,"show",function(){e.hotKey.add(document.documentElement,["esc"],m,{type:"keyup",disableInInput:!0})}),e.custEvent.add(r,"hide",function(){e.hotKey.remove(document.documentElement,["esc"],m,{type:"keyup"}),d=!0})};return g(),v=e.objSup(r,["show","hide"]),p=function(t){return"function"!=typeof f||t||f()!==!1?(v.hide(),e.contains(document.body,r.getOuter())&&document.body.removeChild(r.getOuter()),o):!1},o=r,o.show=function(){return e.contains(document.body,r.getOuter())||document.body.appendChild(r.getOuter()),v.show(),o},o.hide=p,o.setPosition=function(e){return u.style.top=e.t+"px",u.style.left=e.l+"px",o},o.setMiddle=function(){var t,n=e.core.util.winSize(),i=r.getSize(!0);if(window.FrameInner&&window.FrameInner.outInfo){var s=FrameInner.outInfo;"string"==typeof s&&(s=e.strToJson(s));var l=s.parent.scroll.top,a=s.iframe.position.top,c=s.parent.size.height;t=l-a+(c-i.h)/2;var d=n.height-i.h;t>d&&(t=d)}else t=e.core.util.scrollPos().top+(n.height-i.h)/2;return u.style.top=(parseInt(t)>30?t:30)+"px",u.style.left=(n.width-i.w)/2+"px",window.FrameInner&&FrameInner.diaAutoHeight&&FrameInner.diaAutoHeight(u),o},o.setTitle=function(e){return c.innerHTML=e,o},o.setContent=function(e){return"string"==typeof e?l.innerHTML=e:l.appendChild(e),o},o.clearContent=function(){for(;l.children.length;)e.removeNode(l.children[0]);return o},o.setAlign=function(){},o.setBeforeHideFn=function(e){f=e},o.clearBeforeHideFn=function(){f=null},o.unsupportEsc=function(){d=!1},o.supportEsc=function(){d=!0},o}})}),steel.d("utils/kit/dom/cssText",[],function(e,t,n){STK.register("utils.kit.dom.cssText",function(e){var t=function(e,t){for(var n,i=(e+";"+t).replace(/(\s*(;)\s*)|(\s*(:)\s*)/g,"$2$4");i&&(n=i.match(/(^|;)([\w\-]+:)([^;]*);(.*;)?\2/i));)i=i.replace(n[1]+n[2]+n[3],"");return i};return function(e){e=e||"";var n=[],i={push:function(e,t){return n.push(e+":"+t),i},remove:function(e){for(var t=0;t<n.length;t++)0==n[t].indexOf(e+":")&&n.splice(t,1);return i},getStyleList:function(){return n.slice()},getCss:function(){return t(e,n.join(";"))}};return i}})}),steel.d("utils/kit/dom/fix",["utils/kit/dom/cssText"],function(e,t,n){e("utils/kit/dom/cssText"),STK.register("utils.kit.dom.fix",function(e){function t(t){return"none"!=e.core.dom.getStyle(t,"display")}function n(t){t=e.core.arr.isArray(t)?t:[0,0];for(var n=0;2>n;n++)"number"!=typeof t[n]&&(t[n]=0);return t}function i(n,i,o){if(t(n)){var u,s,l,a,c="fixed",d=n.offsetWidth,f=n.offsetHeight,p=e.core.util.winSize(),v=0,m=0,g=e.utils.kit.dom.cssText(n.style.cssText);if(r)switch(u=a=o[1],s=l=o[0],i){case"lt":a=l="";break;case"lb":u=l="";break;case"rt":s=a="";break;case"rb":u=s="";break;case"c":default:u=(p.height-f)/2+o[1],s=(p.width-d)/2+o[0],a=l=""}else{c="absolute";var h=e.core.util.scrollPos();switch(v=u=h.top,m=s=h.left,i){case"lt":u+=o[1],s+=o[0];break;case"lb":u+=p.height-f-o[1],s+=o[0];break;case"rt":u+=o[1],s+=p.width-d-o[0];break;case"rb":u+=p.height-f-o[1],s+=p.width-d-o[0];break;case"c":default:u+=(p.height-f)/2+o[1],s+=(p.width-d)/2+o[0]}l=a=""}"c"==i&&(v>u&&(u=v),m>s&&(s=m)),g.push("position",c).push("top",u+"px").push("left",s+"px").push("right",l+"px").push("bottom",a+"px"),n.style.cssText=g.getCss()}}var r=!(e.core.util.browser.IE6||"CSS1Compat"!==document.compatMode&&STK.IE),o=/^(c)|(lt)|(lb)|(rt)|(rb)$/;return function(t,u,s){function l(n){n=n||window.event,e.core.evt.custEvent.fire(d,"beforeFix",n.type),!f||r&&"c"!=a||i(t,a,c)}var a,c,d,f=!0;if(e.core.dom.isNode(t)&&o.test(u)){var p={getNode:function(){return t},isFixed:function(){return f},setFixed:function(e){return(f=!!e)&&i(t,a,c),this},setAlign:function(e,r){return o.test(e)&&(a=e,c=n(r),f&&i(t,a,c)),this},destroy:function(){r||r&&e.core.evt.removeEvent(window,"scroll",l),e.core.evt.removeEvent(window,"resize",l),e.core.evt.custEvent.undefine(d)}};return d=e.core.evt.custEvent.define(p,"beforeFix"),p.setAlign(u,s),r||e.core.evt.addEvent(window,"scroll",l),e.core.evt.addEvent(window,"resize",l),p}}})}),steel.d("utils/module/mask",["utils/kit/dom/fix"],function(e,t,n){e("utils/kit/dom/fix"),STK.register("utils.module.mask",function(e){function t(){i=e.C("div");var t='<div node-type="outer">';e.core.util.browser.IE6&&(t+='<div style="position:absolute;width:100%;height:100%;"></div>'),t+="</div>",i=e.builder(t).list.outer[0],document.body.appendChild(i),u=!0,r=e.utils.kit.dom.fix(i,"lt");var n=function(){var t=e.core.util.winSize();i.style.cssText=e.utils.kit.dom.cssText(i.style.cssText).push("width",t.width+"px").push("height",t.height+"px").getCss()};c.add(r,"beforeFix",n),n()}function n(t){var n;return(n=t.getAttribute(s))||t.setAttribute(s,n=e.getUniqueKey()),">"+t.tagName.toLowerCase()+"["+s+'="'+n+'"]'}var i,r,o=[],u=!1,s="STK-Mask-Key",l=e.core.dom.setStyle,a=e.core.dom.getStyle,c=e.core.evt.custEvent,d={getNode:function(){return i},show:function(n,o){return u?(n=e.core.obj.parseParam({opacity:0,background:"#000000"},n),i.style.background=n.background,l(i,"opacity",n.opacity),i.style.opacity=n.opacity,i.style.display="",r.setAlign("lt"),o&&o()):e.Ready(function(){t(),d.show(n,o)}),d},hide:function(){return i.style.display="none",nowIndex=void 0,o=[],d},showUnderNode:function(t,r){return e.isNode(t)&&d.show(r,function(){l(i,"zIndex",a(t,"zIndex"));var r=n(t),u=e.core.arr.indexOf(o,r);-1!=u&&o.splice(u,1),o.push(r),e.core.dom.insertElement(t,i,"beforebegin")}),d},back:function(){if(o.length<1)return d;var t,n;return o.pop(),o.length<1?d.hide():(n=o[o.length-1])&&(t=e.sizzle(n,document.body)[0])?(l(i,"zIndex",a(t,"zIndex")),e.core.dom.insertElement(t,i,"beforebegin")):d.back(),d},destroy:function(){c.remove(r),i.style.display="none",lastNode=void 0,_cache={}}};return d})}),steel.d("utils/kit/dom/drag",[],function(e,t,n){STK.register("utils.kit.dom.drag",function(e){return function(t,n){var i,r,o,u,s,l,a,c,d=function(){f(),p()},f=function(){i=e.parseParam({moveDom:t,perchStyle:"border:solid #999999 2px;",dragtype:"perch",actObj:{},pagePadding:5},n),o=i.moveDom,r={},u={},s=e.drag(t,{actObj:i.actObj}),"perch"===i.dragtype&&(l=e.C("div"),a=!1,c=!1,o=l),t.style.cursor="move"},p=function(){e.custEvent.add(i.actObj,"dragStart",v),e.custEvent.add(i.actObj,"dragEnd",m),e.custEvent.add(i.actObj,"draging",g)},v=function(n,r){document.body.style.cursor="move";var o=e.core.util.pageSize().page;if(u=e.core.dom.position(i.moveDom),u.pageX=r.pageX,u.pageY=r.pageY,u.height=i.moveDom.offsetHeight,u.width=i.moveDom.offsetWidth,u.pageHeight=o.height,u.pageWidth=o.width,"perch"===i.dragtype){var s=[];s.push(i.perchStyle),s.push("position:absolute"),s.push("z-index:"+(i.moveDom.style.zIndex+10)),s.push("width:"+i.moveDom.offsetWidth+"px"),s.push("height:"+i.moveDom.offsetHeight+"px"),s.push("left:"+u.l+"px"),s.push("top:"+u.t+"px"),l.style.cssText=s.join(";"),c=!0,setTimeout(function(){c&&(document.body.appendChild(l),a=!0)},100)}void 0!==t.setCapture&&t.setCapture()},m=function(e,n){document.body.style.cursor="auto",void 0!==t.setCapture&&t.releaseCapture(),"perch"===i.dragtype&&(c=!1,i.moveDom.style.top=l.style.top,i.moveDom.style.left=l.style.left,a&&(document.body.removeChild(l),a=!1))},g=function(e,t){var n=u.t+(t.pageY-u.pageY),r=u.l+(t.pageX-u.pageX),s=n+u.height,l=r+u.width,a=u.pageHeight-i.pagePadding,c=u.pageWidth-i.pagePadding;a>s&&n>0?o.style.top=n+"px":(0>n&&(o.style.top="0px"),s>=a&&(o.style.top=a-u.height+"px")),c>l&&r>0?o.style.left=r+"px":(0>r&&(o.style.left="0px"),l>=c&&(o.style.left=c-u.width+"px"))};return d(),r.destroy=function(){document.body.style.cursor="auto","function"==typeof o.setCapture&&o.releaseCapture(),"perch"===i.dragtype&&(c=!1,a&&(document.body.removeChild(l),a=!1)),e.custEvent.remove(i.actObj,"dragStart",v),e.custEvent.remove(i.actObj,"dragEnd",m),e.custEvent.remove(i.actObj,"draging",g),s.destroy&&s.destroy(),i=null,o=null,u=null,s=null,l=null,a=null,c=null},r.getActObj=function(){return i.actObj},r}})}),steel.d("ui/dialog",["utils/kit/extra/language","utils/kit/extra/reuse","utils/module/dialog","utils/module/mask","utils/kit/dom/drag"],function(e,t,n){e("utils/kit/extra/language"),e("utils/kit/extra/reuse"),e("utils/module/dialog"),e("utils/module/mask"),e("utils/kit/dom/drag"),STK.register("ui.dialog",function(e){var t='<div class="W_layer" node-type="outer" style="display:none;position:absolute;z-index:10019"><div class="content"><div class="W_layer_title" node-type="title_content"></div><div class="W_layer_close"><a href="javascript:void(0);" class="W_ficon ficon_close S_ficon" title="#L{关闭}" node-type="close">X</a></div><div node-type="inner"></div></div></div>',n=e.utils.kit.extra.language,i=null,r=function(){var i=e.utils.module.dialog(n(t));return e.custEvent.add(i,"show",function(){e.utils.module.mask.showUnderNode(i.getOuter(),{opacity:.5,background:"#000000"})}),e.custEvent.add(i,"hide",function(){e.utils.module.mask.back(),i.setMiddle()}),i.destroy=function(){o(i);try{i.hide(!0)}catch(e){}},i},o=function(e){e.setTitle("").clearContent(),i.setUnused(e)};return function(t){var n=e.parseParam({isHold:!1},t),u=n.isHold;n=e.core.obj.cut(n,["isHold"]),i||(i=e.utils.kit.extra.reuse(r));var s=i.getOne();return u||(e.custEvent.add(s,"hide",function(){e.custEvent.remove(s,"hide",arguments.callee),o(s)}),e.custEvent.add(s,"show",function(){i.setUsed(s)})),s}})}),steel.d("ui/prompt",["utils/kit/extra/language","utils/kit/extra/reuse","utils/kit/dom/smartInput","utils/module/layer","ui/dialog"],function(e,t,n){e("utils/kit/extra/language"),e("utils/kit/extra/reuse"),e("utils/kit/dom/smartInput"),e("utils/module/layer"),e("ui/dialog"),STK.register("ui.prompt",function(e){var t='<div class="layer_prompt" node-type="outer"><p class="son_title" node-type="inner"></p><dl class="clearfix"><dt node-type="label"></dt><dd><input type="text" class="W_input W_input_default" value="" node-type="input" /><p class="W_error" node-type="errorBox"><span class="icon_del"></span><span node-type="errorTxt"></span></p></dd></dl><div class="btn"><a class="W_btn_b" href="javascript:void(0);" node-type="OK"></a><a class="W_btn_a" href="javascript:void(0);" node-type="cancel"></a></div></div>',n=e.utils.kit.extra.language,i=null,r=function(e,t){e.getDom("inner").innerHTML=t.info,e.getDom("label").innerHTML=t.label,e.getDom("OK").innerHTML="<span>"+t.OKText+"</span>",e.getDom("cancel").innerHTML="<span>"+t.cancelText+"</span>",e.getDom("errorBox").style.visibility="hidden",e.getDom("errorTxt").innerHTML="",e.input.setValue(t.value),e.input.setNotice(t.notice),e.input.restart()},o=function(o){var u,s,l,a,c,d;return i||(i=e.utils.kit.extra.reuse(function(){var i=e.utils.module.layer(n(t));return i.input=e.utils.kit.dom.smartInput(i.getDom("input")),i})),s=i.getOne(),l=e.ui.dialog(),l.appendChild(s.getOuter()),l.setTitle(o.title),r(s,o),a=function(){var e=o.check(s.getDom("input").value);return e.status?hideError():d(e.msg),e.status},c=function(){a()&&o.OK(s.getDom("input").value)},d=function(e){s.getDom("errorBox").style.visibility="visible",s.getDom("errorTxt").innerHTML=e},hideError=function(){s.getDom("errorBox").style.visibility="hidden"},e.custEvent.add(s.input,"enter",c),e.addEvent(s.getDom("OK"),"click",c),e.addEvent(s.getDom("cancel"),"click",l.hide),e.addEvent(s.getDom("input"),"blur",a),e.custEvent.add(l,"hide",function(){e.custEvent.remove(l,"hide",arguments.callee),e.custEvent.remove(s.input,"enter",c),e.removeEvent(s.getDom("OK"),"click",c),e.removeEvent(s.getDom("cancel"),"click",l.hide),e.removeEvent(s.getDom("input"),"blur",a),i.setUnused(s),o.cancel(),s=null,l=null}),u={},u.pmt=s,u.dia=l,u.hide=l.hide,u.showError=d,u.hideError=hideError,u};return function(t){var i,r;return i=e.parseParam({title:n("#L{提示}"),notice:"",value:"",info:"",label:"",OK:e.funcEmpty,cancel:e.funcEmpty,check:function(){return{status:!0}},OKText:n("#L{确定}"),cancelText:n("#L{取消}")},t),r=o(i),r.dia.show().setMiddle(),r}})});