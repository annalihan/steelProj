steel.d("utils/module/layer",[],function(t,e,i){STK.register("utils.module.layer",function(t){var e=function(t){var e={};return"none"==t.style.display?(t.style.visibility="hidden",t.style.display="",e.w=t.offsetWidth,e.h=t.offsetHeight,t.style.display="none",t.style.visibility="visible"):(e.w=t.offsetWidth,e.h=t.offsetHeight),e},i=function(i,r){r=r||"topleft";var n=null;if("none"==i.style.display?(i.style.visibility="hidden",i.style.display="",n=t.core.dom.position(i),i.style.display="none",i.style.visibility="visible"):n=t.core.dom.position(i),"topleft"!==r){var o=e(i);"topright"===r?n.l=n.l+o.w:"bottomleft"===r?n.t=n.t+o.h:"bottomright"===r&&(n.l=n.l+o.w,n.t=n.t+o.h)}return n};return function(r){var n=t.core.dom.builder(r),o=n.list.outer[0],s=n.list.inner[0],l=t.core.dom.uniqueID(o),a={},d=t.core.evt.custEvent.define(a,"show");t.core.evt.custEvent.define(d,"hide");var u=null;return a.show=function(){return o.style.display="",t.core.evt.custEvent.fire(d,"show"),a},a.hide=function(){return o.style.display="none",t.custEvent.fire(d,"hide"),a},a.getPosition=function(t){return i(o,t)},a.getSize=function(t){return(t||!u)&&(u=e.apply(a,[o])),u},a.html=function(t){return void 0!==t&&(s.innerHTML=t),s.innerHTML},a.text=function(e){return void 0!==text&&(s.innerHTML=t.core.str.encodeHTML(e)),t.core.str.decodeHTML(s.innerHTML)},a.appendChild=function(t){return s.appendChild(t),a},a.getUniqueID=function(){return l},a.getOuter=function(){return o},a.getInner=function(){return s},a.getParentNode=function(){return o.parentNode},a.getDomList=function(){return n.list},a.getDomListByKey=function(t){return n.list[t]},a.getDom=function(t,e){return n.list[t]?n.list[t][e||0]:!1},a.getCascadeDom=function(e,i){return n.list[e]?t.core.dom.cascadeNode(n.list[e][i||0]):!1},a}})}),steel.d("ui/bubbleLayer",["utils/module/layer"],function(t,e,i){t("utils/module/layer"),STK.register("ui.bubbleLayer",function(t){var e='<div class="W_layer" node-type="outer" style="display:none;"><div class="bg"><div class="effect"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td><div class="content clearfix" node-type="inner"></div></td></tr></tbody></table><div node-type="arrow" class="#{arrow_type}"></div></div></div></div>';return function(i,r){var n,o,s,l,a,d,u=function(t){return t=t?"arrow arrow_"+t:""},c=function(t){return o.style.top=t.t+"px",o.style.left=t.l+"px",l},h=function(){var e=t.core.util.winSize(),i=n.getSize(!0);return o.style.top=t.core.util.scrollPos().top+(e.height-i.h)/2+"px",o.style.left=(e.width-i.w)/2+"px",l},f=function(t){return"string"==typeof t?s.innerHTML=t:s.appendChild(t),l},p=function(t,e){var i="";return"t"===t||"b"===t?"right"===e?i="left:auto;right:30px;":"center"===e&&(i="left:auto;right:"+(o.offsetWidth/2-8)+"px;"):"l"!==t&&"r"!==t||"bottom"!==e||(i="top:auto;bottom:20px;"),a.className=u(t),a.style.cssText=i,l},y=function(){r=u(r),d=e.replace(/\#\{arrow_type\}/g,r),n=t.utils.module.layer(d),o=n.getOuter(),s=n.getDom("inner"),a=n.getDom("arrow"),l=n,i&&f(i),document.body.appendChild(o)};return y(),l.setPostion=c,l.setMiddle=h,l.setContent=f,l.setArrow=p,l}})}),steel.d("utils/kit/extra/language",[],function(t,e,i){STK.register("utils.kit.extra.language",function(t){return window.$LANG||(window.$LANG={}),function(e,i){var r=t.core.util.language(e,$LANG);return r=r.replace(/\\}/gi,"}"),i&&(r=t.templet(r,i)),r}})}),steel.d("ui/popCard",["ui/bubbleLayer","utils/kit/extra/language"],function(t,e,i){t("ui/bubbleLayer"),t("utils/kit/extra/language"),STK.register("ui.popCard",function(t){var e=5,i=28,r=38,n=200,o=200,s=function(e,i,r){var n,o,s,l,a,d,u=t.core.util.scrollPos(),c=t.core.dom.position(e),h=t.core.util.winSize();return a=e.offsetWidth,d=e.offsetHeight,s=c.t-u.top,n=c.l-u.left,o=h.width-n-a,l=h.height-s-d,{t:s,l:n,r:o,b:l,w:a,h:d,x:c.l,y:c.t}},l=function(t){var i=t.nodeW,r=t.nodeH,n=t.dis,o=t.cardWidth,s=t.cardHeight,l=t.arrow,a=(t.node,t.offsetH),d=t.offsetW,u=(t.arPos,{});switch(l){case"t":u.l=n.x-d+i/2,u.t=n.y-e-s;break;case"r":u.l=n.x+i+e,u.t=n.y-a+r/2;break;case"b":u.l=n.x-d+i/2,u.t=n.y+r+e;break;case"l":default:u.l=n.x-o-e,u.t=n.y-a+r/2}return u},a=function(e){var n=e.node,a=e.cardWidth,d=e.cardHeight,u=e.arrowPos||"auto",c=(e.order||"b,r,t,l").split(","),h=c[0],f=Math.max(d,o),p={l:a,b:f,t:f,r:a},y={l:"r",b:"t",t:"b",r:"l"},g=s(n),b=g.w,v=g.h,m=i,w=r,P=n.getClientRects?n.getClientRects():null,x=(parseInt(t.getStyle(n,"lineHeight"),10),t.fixEvent(e.event));if(P&&P.length>1){var H;x.pageX-g.x>b/2?(H=P[0],g.x=H.left,g.l+=H.left-P[1].left,v=H.bottom-H.top,b=H.right-H.left):(H=P[1],g.y+=H.top-P[0].top,g.r+=P[0].right-H.right,v=H.bottom-H.top,b=H.right-H.left)}for(var L=0,T=c.length;T>L;L++){var C=c[L];if(g[C]>p[C]){h=C;break}}"auto"===u&&(("t"===h||"b"===h)&&b/2+g.r<a-r?u="right":v/2+g.b<d-i&&(u="bottom")),"right"===u?w=a-r:"bottom"===u?m=d-i:"center"===u&&(w=a/2);var W=l({nodeW:b,nodeH:v,dis:g,cardWidth:a,cardHeight:d,arrow:h,node:n,offsetH:m,offsetW:w});return{dire:y[h],pos:W,arPos:u}},d=function(t,e){return function(){return t.apply(e,arguments)}},u=function(){this.bubLayer=t.ui.bubbleLayer(),this.cardPanel=this.bubLayer.getOuter(),this.initBind()};return u.prototype={initBind:function(){var e=d(this.stopHide,this),i=d(this.hideCard,this);t.addEvent(this.cardPanel,"mouseover",e),t.addEvent(this.cardPanel,"mouseout",i),this.dEvent=t.core.evt.delegatedEvent(this.cardPanel)},stopShow:function(){this.showTimer&&clearTimeout(this.showTimer)},stopHide:function(){this.hideTimer&&clearTimeout(this.hideTimer)},showCard:function(t){var e=t.zIndex||9999;this.cardPanel.style.zIndex=e,this.bubLayer.setContent(t.content).show(),this.node=t.node,this.arrowPos=t.arrowPos,this.order=t.order,this.direPos=a({node:this.node,cardWidth:this.cardPanel.offsetWidth,cardHeight:this.cardPanel.offsetHeight,arrowPos:this.arrowPos,order:this.order,event:t.event}),this.bubLayer.setPostion(this.direPos.pos).setArrow(this.direPos.dire,this.direPos.arPos)},setContent:function(t){var e=this.cardPanel.offsetHeight;if(this.bubLayer.setContent(t),"b"===this.direPos.dire){var i=this.cardPanel.offsetHeight-e;this.bubLayer.setPostion({l:this.direPos.pos.l,t:this.direPos.pos.t-i})}},hideCard:function(){var t=this;this.hideTimer=setTimeout(function(){t.bubLayer.hide()},n)}},function(){return new u}})});